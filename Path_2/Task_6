-- 6. Find the two highest paid people per department.
WITH SALARY_RANK AS (
SELECT EMP_NAME, DEPT_ID, SALARY,
RANK () OVER(
	PARTITION BY DEPT_ID ORDER BY SALARY DESC
) AS RANK_EMP
FROM EMPLOYEE)
SELECT *
FROM SALARY_RANK
WHERE RANK_EMP <= 2;